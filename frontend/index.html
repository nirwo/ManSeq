<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datacenter Manager</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link href="dist/styles.css" rel="stylesheet">
    <style>
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-online { background-color: #10B981; }
        .status-offline { background-color: #EF4444; }
        .status-error { background-color: #F59E0B; }
        .status-pending { background-color: #6B7280; }
        .status-unknown { background-color: #9CA3AF; }
        .error-message {
            background-color: #FEE2E2;
            border: 1px solid #EF4444;
            color: #B91C1C;
            padding: 0.5rem;
            border-radius: 0.375rem;
            margin-bottom: 1rem;
        }
        .success-message {
            background-color: #D1FAE5;
            border: 1px solid #10B981;
            color: #047857;
            padding: 0.5rem;
            border-radius: 0.375rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="app" class="container mx-auto px-4 py-8">
        <!-- Error/Success Messages -->
        <div v-if="errorMessage" class="error-message">
            {{ errorMessage }}
            <button @click="errorMessage = ''" class="float-right">&times;</button>
        </div>
        <div v-if="successMessage" class="success-message">
            {{ successMessage }}
            <button @click="successMessage = ''" class="float-right">&times;</button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div v-for="app in applications" :key="app.id" 
                 class="bg-white p-6 rounded-lg shadow-md">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">{{ app.name }}</h2>
                    <div class="space-x-2">
                        <button @click="editApplication(app)" 
                                class="text-blue-600 hover:text-blue-800">
                            Edit
                        </button>
                        <button @click="deleteApplication(app.id)"
                                class="text-red-600 hover:text-red-800">
                            Delete
                        </button>
                    </div>
                </div>
                <p class="text-gray-600 mb-4">{{ app.description }}</p>
                
                <!-- Servers in this application -->
                <div class="space-y-4">
                    <div v-for="server in getServersByApp(app.id)" :key="server.id" 
                         class="border p-4 rounded">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center">
                                <span class="status-indicator" 
                                      :class="getStatusClass(server.status)"></span>
                                <span class="font-medium">{{ server.name }}</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <!-- Shutdown Status Controls -->
                                <select v-model="server.shutdown_status" 
                                        @change="updateShutdownStatus(server)"
                                        class="rounded border p-1 text-sm">
                                    <option value="Not Started">Not Started</option>
                                    <option value="In Progress">In Progress</option>
                                    <option value="Completed">Completed</option>
                                </select>
                                <button @click="editServer(server)" 
                                        class="text-blue-600 hover:text-blue-800">
                                    Edit
                                </button>
                                <button @click="deleteServer(server.id)" 
                                        class="text-red-600 hover:text-red-800">
                                    Delete
                                </button>
                            </div>
                        </div>
                        <div class="text-sm text-gray-600">
                            <p>Type: {{ server.type }}</p>
                            <p>Host: {{ server.hostname }}:{{ server.port }}</p>
                            <p>Owner: {{ server.owner_name }}</p>
                            <p>Shutdown Status: <span :class="{
                                'text-yellow-600': server.shutdown_status === 'In Progress',
                                'text-green-600': server.shutdown_status === 'Completed',
                                'text-gray-600': server.shutdown_status === 'Not Started'
                            }">{{ server.shutdown_status }}</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>
